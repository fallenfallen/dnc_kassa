=============== выпущен 1.2.6 patch5 ================ 29/02/2012 ================
#------------29/02/2012 ------------------
1) dncutil->stringconvert.h - подправлена функция toString<double>(): 
    добавлена установка точности (кол-ва разрядов после запятой) при преобразовании чисел с плавающей точкой

#------------27/02/2012 ------------------
1) reshka, SetupParam - добавлены функции перезагрузки данных по секциям после вызова RMK из главного меню.
    !!!ВАЖНО!!! Раньше в отчет по секциям, распечатанный из главного меню, данные по секциям на момент инициализации главного меню.
    Если в режиме регистрации продаж накопления по секциям менялись, то при возврате в главное меню эта информация не перезагружалась из БД.

#------------24/02/2012 ------------------
1) PostgresLib - реализована поддержка нескольких диапазонов ограничения продажи товаров
2) RMK - реализована поддержка нескольких диапазонов ограничения продажи товаров
3) Внесены последние исправления для работы со СБЕРом

#------------22/02/2012 ------------------
1) Receipt - эталонное значение процентной скидки на чек должно рассчитываться, как Окр(Цена*Колво) - Окр(Цена*Колво*(1-Процент/100)) 
    - именно к этой величине должно подгоняться распределение скидки по позициям
2) RMK->registrationform.ui.h->PrintCheck() - исправлено закрытие чека при работе БЕЗ ФР

#------------20/02/2012 ------------------
1) WareSystem - исправлена загрузка иерархии групп. Раньше была попытка преобразовать строковый код к числу и записать в целочисленный идентификатор group_id;
    Теперь для новых групп идентификатор создается как max(group_id) + 1
2) DBUpdate - изменены правила обновления для ограничения по времени продажи товаров (теперь диапазонов ограничения может быть несколько)    
3) WareSystem, upload - добавлена загрузка (добавление/обновление) нескольких диапазонов ограниченя продажи товаров по времени

#------------17/02/2012 ------------------
1) Receipt->TestMinPrice() - подправлен расчет скидки на чек, распределенной на позицию, в случае, когда ограничение по мин. цене отключено в настройках

#------------15/02/2012 ------------------
1) RMK->registrationform.h - функция вывода текущих даты/времени в окно регистрации продаж InitPkDateTime() перенесена в CheckFlag() из DateTimeControl()
2) Receipt -> в очередной раз пересмотрены алгоритмы распределения скидки на чек по позициям. Проблема заключается в том, что если скидку рассчитывать как процент от суммы позиции, 
    то, за счет округления результата до копеек, могут возникать неравенства Round(price*quantity) <> Round(summ_with_discount) + Round(summ_of_discount).
    Предлагается summ_of_discount рассчитывать как разность между summ = Round(price*quantity) и  Round(summ * (1 - procent)), т.е. округлять надо сумму позиции с учетом скидки, а
    сумму скидки считать не через процент, а в абсолютном значении "округленная до копеек исходная сумма - округленная до копеек сумма с учетом скидки".
    В целом, конечно, крышу сносит от этих алгоритмов 8-)
3) SectionSetup - основное окно теперь выводится по центру рабочего стола. Сообщение об ошибке (если основное окно еще не отобразилось) выводится близко к центру рабочего стола
    (а не в левом нижнем углу)    
    
#------------09/02/2012 ------------------
1) библиотека HWSRV разделена по платежным системам.
2) в HWSRV функция PS_GetPrintCanselCheck() стала называться PS_GetPrintCancelCheck() в связи с этим внесено соответствующее исправление в KkmRegistration
3) DeviceConf поддерживает платежную систему СБЕРБАНК
4) внесены изменения в InpasLib в функцию Payment() с целью корректного вывода ответа о проведении транзакции платежной системы СБЕРБАНКА
5) исправлена ошибка HWSRV при неправильно введенном пароле для протокола ШТРИХ в первый раз в DeviceConf и сохранении данной ошибки до переинициализации HWSRV. Функция void CloseConnection(void) стала виртуальной и должна быть реализована в каждом протоколе ФР.
#------------02/02/2012 ------------------
1) HWSRV->kkm_orion.cpp - исправлена печать рекламного текста в неактивированном режиме для ОРИОН-ФР01К

#------------27/01/2012 ------------------
1) KkmRegistration - подправлена (преобразование к cp1251) печать кодов товаров, содержащих русские буквы (раньше отправлялись в ФР в юникоде)

#------------25/01/2012 ------------------
1) RMK->registrationform.ui.h - добавлен вывод окна об отсутствии чековой ленты с запросом её вставки для продолжения.
    Пока только для ФР ШТРИХ
    Окно выдается, если по ФР прошла регистрация (до этого можно спокойно перепечатывать весь чек), но не прошла команда
    закрытия чека.
2) RMK->registrationform.ui.h - если фискальная часть распечаталась, транзакции будут записаны в БД вне зависимости от ошибок
    при печати нефискальной части ( при работе с авторазбиением по секциям)	

#------------24/01/2012 ------------------
1) HWSRV->kkm_shrih.cpp->CloseCheckMultiType() - добавлен отлов AdvancedMode = 2 (активное отсутствие бумаги во время печати закрытия чека)
2) HWSRV->kkm_shtrih.cpp->ContinuePrinting() - добавлен опрос состояния ФР после посыла команды продолжения печати (принтер должен допечатать строки)

=============== выпущен 1.2.6 patch4 ================ 19/01/2012 ================
#------------19/01/2012 ------------------
1) Upload->upload_shtrih.cpp - флаг "без ввода количества" для протокола ШТРИХ переключен по-умолчанию в "1", т.е. "разрешено" (было "0")

!!! в сборку 1.2.6 patch3 от 16.01.2012 в 32-битную сборку попали 64-битные демоны upload, unload, edsd !!!

=============== выпущен 1.2.6 patch3 ================ 16/01/2012 ================
#------------13/01/2012 ------------------
1) PostgresLib - в функцию Get_PutOut_Check_Info получения информации об отложенном чеке добавлено получение id менеджера-консультанта
2) RMK->registrationform.ui.h - добавлена подгрузка менеджера-консультанта в копию чека, в чек возврата, в восстановленный чек
3) InsertTransaction - добавлен запрос следующего номера отложенного чека при записи откладываемого чека
4) PostgresLib->trans_pgsql.cpp - добавлена функция получения следующего номера откладываемого чека GetPutOutCheckNumber()
    ВАЖНО!!! Нумерация отложенных чеков теперь сделана независимой и сквозной в рамках года. Восстановленные отложенные чеки на нумерацию не влияют.

#------------12/01/2012 ------------------
1) upload, dncwaresystem - добавлена обработка команд !!!ADDTAXRATES, !!!DELETETAXES в протокол ДЭНСИ
2) ServiceLib - добавлена печать итогов по скидкам/надбавкам в отчет по кассирам

#------------11/01/2012 ------------------
1) dncwaresystem->WareSystem.cpp - добавлена инициализация переменной taxgroup_catalog, иначе возможен SIGSEGV при загрузке списка налоговых групп

#------------28/12/2011 ------------------
1) WareSystem - Section.cpp - добавлено округление суммы внесения/выплаты по секциям (перед сохранением в БД; используется только при авторазбиении товаров/чека по секциям)

#------------23/12/2011 ------------------
1) ReaderConfig - подправлено чтение конфигурационного файла по умолчанию (игнорируя /home текущего пользователя)
2) HWSRV - заменен на версию от Ирины (поддержка СБЕРБАНКА)
3) DevicesConf - заменен на версию от Ирины (добавлена настройка межсимвольного таймаута для USB/KB-сканеров)
4) RMK->main.cpp - добавлена инициализация переменной TIME_INTERSYMBOL в библиотеке работы с клавиатурными устройствами значением, указанным в настройках сканера в HWSRV
5) RMK->canceldiscountform.ui.h - добавлена возможность отменять автоматические скидки (чтобы можно было вернуться в режим регистрации продаж по чеку)
6) PostgresLib->setup_dis_pgsql.cpp - возврщен старый алгоритм сохранения списка фиксированных скидок (через предварительное удаление всех текущих скидок)

#------------21/12/2011 ------------------
1) HWSRV->kkm/kkm_shtrih.h - удалено определение переменной bool portBuzy - конфликтует с определением этой же переменной в kkm_base.h
2) RMK->RegistrationForm.ui.h - таймаут проверки синхронизации даты/времени увеличен с 10 секунд до 60
3) RMK->RegistrationForm.ui.h - работа с KB/USB сканерами переделана по аналогии с COM-вариатном (вызов BarcodeEvent не немедленно, а через общий таймер проверки флагов).
    Это автоматически добавляет проверку занятости порта ФР с тем, чтобы обработка штрих-кода не нарушила таймауты работы с ФР.

#------------20/12/2011 ------------------
1) ReaderConfig - добавлен флажок try_home (искать настройки в домашнем каталоге)
2) PostgresLib->unload_pgsql.h/cpp, class_pgsql.h/cpp - добавлен флажок try_home (проброска до ReaderConfig)
3) RMK->RegistrationForm.ui.h - по нажатию ПРОМИТОГА, ОПЛАТЫ или РАСЧЕТА сначала вызывается расчет автоматических скидок (если существует схема скидок с признаком is_default = true)

#------------16/12/2011 ------------------
1) StateStore - добавлено сохранение предыдущего состояния чека (для перехода INS_TEXT-INS-MESS-REC)
2) RMK - начато добавление алгоритмов контроля предыдущего состояния чека (чтобы заблокировать функционал,
    запрещенный в состоянии начисленной скидки на чек после нажатия ПРОМИТОГ, если скидка уже была начислена)
3) RMK->IntermediateResult() - добавлен поиск и начисление автоматической скидки на чек

#------------14/12/2011 ------------------
1) DBUpdate - добавлена проверка/создание поля is_default в таблицу схем автоматических скидок auto_scheme;
2) PostgresLib->reg_pgsql.h/cpp - добавлена функция GetDefaultSchemeId() для запроса кода схемы автоскидок, установленной как схема по-умолчанию ( -1, если таких схем нет)
3) Upload->DncCommand.cpp - добавлено заполнение поля is_default для схем скидок, установка схемы скидок по умолчанию
4) WareSystem - добавлено поле is_default к схемам скидок, реализована загрузка значений 0/1 в этом поле

#------------12/12/2011 ------------------
1) KkmRegistration - добавлена печать даты/времени в ЕНВД-квитанциях (при авторазбивке по секциям)

#------------08/12/2011 ------------------
1) RMK - журнал закрытия чеков перенесен из /tmp в /tmp/dancy/registration_goods.log
2) HWSRV->kkm_prim.cpp - повышена скорость реакции на ошибки связи с ФР (в т.ч. полное отсутствие связи)
3) DebugLevelLog->PrintTime() - исправлена печать даты/времени (раньше всегда писалось в /tmp/hwsrv_log строчками без самой информации)

#------------06/12/2011 ------------------
1) !!! ВАЖНО !!! HWSRV->kkm/kkm_prim.cpp -> readdata() - исправлен SIGSEGV, связанный с переполнением буфера при чтении данных из порта

#------------05/12/2011 ------------------
1) !!! ВАЖНО !!! RMK->registrationform.ui.h->CheckFlag() - добавлен контроль флага ECR_IsPortBuzy() перед вызовом обработки штрих-кода с тем, чтобы не нарушалась начатая работа с ФР

#------------01/12/2011 ------------------
1) HWSRV->kkm/kkm_prim.cpp - время ожидания освобождения порта увеличено до 2 сек (40 циклов по 50 миллисекунд)
2) !!! ВАЖНО !!! RMK->registrationform.ui.h - заблокирован вызов DateTimeControl() (а, следовательно, и ECR_ReadStatus()), если идет печать чека

#------------29/11/2011 ------------------
1) HWSRV->kkm/kkm_prim.h/cpp - добавлен контроль занятого порта (portBuzy), добавлено считывание номера смены (раньше номер смены даже не инициализировался!!! Там было случайное число!!!)

#------------25/11/2011 ------------------
1) PostgresLib, daemon_unload, RMK - закончена работа над функционалом загрузки/выгрузки, регистрации информации по менеджерам-консультантам

#------------23/11/2011 ------------------
1) HWSRV - в драйвер ФР добавлено свойство portBuzy и функция IsPortBuzy(), позволяющие определить, не занят ли порт ФР
2) !!!ОТМЕНЕНО!!! HwSignalController - в обработчик сигнала от сканера добавлена задержка (макс. 10 циклов по 50 мсек. = 0.5 сек.) отправки сигнала в интерфейс, в случае, если порт ФР занят
    (во избежание сбоя работы с ФР по таймаутам)
3) KeyboardDevices - константа TIME_INTERSYMBOL переделана в переменную (с тем же значением 200 мс по умолчанию). Теперь можно дописать настройку 
    межсимвольного таймаута для клавиатурных сканеров в DevicesConf
    
#------------22/11/2011 ------------------
1) dncwaresystem - добавлены классы для работы со списком менеджеров-консультантов
2) Upload -> DncCommand.cpp/h - подправлена и протестирована загрузка списка менеджеров-консультантов (!!!ADDMANAGERS, !!!DELETEMANAGERS)
3) dncwaresystem - добавлен класс для работы с налоговыми группами
4) Upload -> DncCommand.cpp/h - добавлена команда загрузки налоговых групп !!!ADDTAXGROUPS

#------------21/11/2011------------------
1) Upload -> DncCommand.cpp/h - добавлены классы работы со списком менеджеров-консультантов

#------------18/11/2011------------------
1) PostgresLib->reg_pgsql.h/cpp - добавлена функция Query_Cnt_Managers() запроса кол-ва менеджеров-консультантов в БД LinCash
2) Messages -> добавлена ошибка 120 "Список менеджеров-консультантов пуст"

#------------17/11/2011------------------
1) HWSRV->kkm/kkm_shtrih.h/cpp - добавлен алгоритм обработки флага portBuzy во избежание одновременных запросов к ФР (max 10 раз по 50 msec)

#------------14/11/2011------------------
1) HWSRV->hwsrv.h, hwsrv.cpp, object_hwsrv.cpp, psdrv.cpp - внесены изменения Ирины для корректной печати слипов
2) KkmRegistration->kkmregistration.cpp - исправлена функция PrintCreditInfo() (по вышеуказанной причине)
3) RMK -> registrationform.ui.h -> PrintCheck() - внесены изменения Ирины для корректной печати слипов

#------------11/11/2011------------------
1) KkmRegistration -> kkmregistration.cpp - добавлен возврат кода ошибки драйвера ккм в функцию печати чека (там, где не хватало)
2) HWSRV->/kkm/kkm_shtrih.cpp - уменьшено число повторных попыток восстановления связи с ФР, внесены исправления с целью ускорения работы драйвера при отсутствии связи с ФР
3) RMK->kkmregistration.ui.h - уменьшено время реакции на отсутствие связи с ФР в различные моменты печати чека (печать строк, команда регситрации, команда закрытия чека...)

#------------10/11/2011------------------
1) Receipt -> receipt.cpp - исправлен алгоритм распределения итоговой скидки на чек по позициям в случае автоограничения по минимальной цене

#------------08/11/2011------------------
1) HWSRV->/kkm/kkm_casby.cpp - подправлен сброс флага portBuzy для КАСБИ-ФР01К (иначе возможен бесконечный цикл)
2) RMK -> printreceipt.cpp -> GetReceiptTable() - подправлена нумерация позиций в таблице чека (для печати документов по html-шаблонам) 
    - теперь нумерация сквозная (вместо номера позиции в чеке), т.к. сторнированные позиции в печатную форму не попадают,
    получались дырки в нумерации позиций в печатной форме

=============== выпущен 1.2.6 patch2 ================
#------------28/10/2011------------------
1) PostgresLib - добавлены правила выгрузки транзакций 57/58 в протоколы АТОЛ/ДЭНСИ
2) HWSRV->hwsrv.cpp, kkm_atol.cpp - добавлена работа с FPrint-22 (UModel = 52)

#------------27/10/2011------------------
1) InpasLib, HWSRV-> psdrv.cpp - внесены исправления в работу с ИНПАС Pulsar, подготовленные Ириной ( обработка ошибки отрезчика от ФР )
2) Receipt -> receipt.cpp -> CloseReceipt() - добавлена очистка списка скидок на чек.
3) DBUpdate - добавлено создание индекса на поле longtitle в таблице ware (для ускорения поиска по наименованию товара)

#------------25/10/2011------------------
1) RMK, PostgresLib - добавлена работа с отложенными чеками (пока без печати квитанций). Новая комбинация клавиш - Cntrl+L (и для откладывания, и для восстановления)

#------------24/10/2011------------------
1) DBUpdate - добавлен функционал обновления БД dnc_eds (используется демоном связи с дисконтными системами)
2) Messages - добавлено описание ошибок 116 ("Нет ни одного отложенного чека"), 117 ("В БД нет отложенного чека с указанным номером")

#------------21/10/2011------------------
1) Receipt->receipt.cpp - исправлен алгоритм начисления надбавки на чек (для надбавки должно использоваться сравнение по абсолютному значению,
    поскольку надбавки передаются отрицательными значениями)
2) SectionSetup - разрешено удаление фискальной секции, если она осталась одна (т.е. возврат к стандартному режиму работы без секций)
3) DBUpdate - подправлено обновление таблицы sections в случае обновления с ранних первых сборок ДЭНСИ: КАССы с секциями
4) RMK->registrationform.ui.h->PutOut() - добавлена проверка права на отмену чека для откладывания чека (потом надо будет заменить на отдельное право) 

#------------20/10/2011------------------
1) Receipt->receipt.cpp - исправлен алгоритм распределения скидки на чек по позициям (также влияет на запись поля round_sum в транзакциях)
    Раньше расхождение по отчету по секциям и Z-отчету могло достигать нескольких десятков копеек за день.

#------------18/10/2011------------------
1) DBUpdate - тип столбца round_sum в таблице transaction обновляется до numeric(15,3). Текущего numeric(8,3) явно не хватает с учетом разрядности полей цены и кол-ва.
2) SectionSetup->SectionSetupForm.cpp->DropSection() - добавлено окно подтверждения удаления фискальной секции
3) dncwaresystem->SectionCatalog.cpp - отключена блокировка удаления фискальной секции

#------------17/10/2011------------------
1) KkmRegistration->kkmregistration.cpp -> добавлена печать копии чека продажи/возврата на ОРИОН-ФР01К
2) RMK->registrationform.ui.h->InitCash() - добавлено автопродолжение печати документа при входе в режим регистрации продаж, в случае соответствующего статауса ФР
3) ServiceLib->reportform.ui.h->init() - добавлено автопродолжение печати документа при входе в режим регистрации продаж, в случае соответствующего статауса ФР
4) HWSRV-> работа с ОРИОН-ФР01К
5) DevicesConf-> добавлена настройка ОРИОН-ФР01К
6) ServiceLib->reportform.ui.h - добавлена печать отчетов по кассирам/по товарам для ОРИОН-ФР01К

#------------14/10/2011------------------
1) RMK -> registrationform, visualsearch -> добавлен контроль введенного веса/кол-ва товара при регистрации через визуальный поиск
2) RMK -> registrationform.ui.h -> если введено количество, тогда операция повтора продажи (Cntrl+R) сработает с указанным кол-вом
3) PostgresLib -> trans_pgsql.cpp -> Get_Registration_Check_Info() - подправлена загрузка позиций чека возврата (по номеру чека), если в исходном
    чеке были товары, регистрация которых без ввода количества запрещена
4) KkmRegistration -> kkmregistration.cpp - восстановлена печать в чеке цены за кг. и кол-ва для весовых товаров
 
#------------13/10/2011------------------
1) Messages -> добавлена ошибка 115 ("не введен вес/кол-во")
2) Receipt -> receipt.h - добавлена константа ALLOWWITHOUTQTTY (флаг регистрации без ввода кол-ва)
3) PostgresLib -> reg_pgsql.h / reg_pgsql.cpp -> New_Receipt_Record(), CheckProductAttr() - добавлена обработка флага регистрации без ввода кол-ва
    признак введенного кол-ва передается последним параметром "bool qttyset"
4) AddWareController->addwarecontroller.h / .cpp -> AddWare(), AddNewPosition() - добавлена передача признака введенного кол-ва bool qttyset
5) RMK->registrationform.ui.h->AddWareByBarcode(), RegisterByPrice() - добавлена передача признака введенного кол-ва

#------------11/10/2011------------------
1) DBUpdate->main.cpp - добавлены типы транзакций 57 (отложенный чек) и 58 (отложенный чек восстановлен)
2) InsertTransactions->insert_transaction.cpp->InserCheckRegistrationsTransactions() - реализована запись полного набора транзакций по отложенным чекам 
    ( стандартный набор транзакций завершается транзакцией 57 )

#------------10/10/2011------------------
1) RMK->registrationform.ui.h->CancelCheck() - отключена запись транзакций отмены чека для КОПИИ чека
2) RMK->registrationform.ui.h->CheckList() - заголовок окна со списком чеков меняется в зависимости от назначения (возврат/копия чека)
3) RMK->promptingform.ui.h->InsertValueInTable() - в окно "HELP" добавлено описание комбинации клавиш Cntrl+L для отложенных чеков
4) RMK->registrationform.ui.h - проведена подготовка к работе с отложенными чеками
5) InsertTransactions->insert_transaction.cpp->InsertCloseCheckTransactions() - добавлена запись транзакции отложенного чека 57 (для checktype = 98/99 - возврат/продажа) 

1.2.6 patch2 beta 07/10/2011
#------------06/10/2011------------------
1) KkmRegistration->PrintCreditInfo() - исправлен алгоритм печати слипа по банковскому платежу
2) HWSRV->ewdrv.cpp - подкорректирован вывод отладочной информации для протокола весов "Меркурий". Вместо замусоривания вывода строчкной mercury_askweight()
    теперь выводится полученный от весов вес в граммах, причем только перед отправкой наверх сигнала о полученном весе (т.е. когда вес изменился).
3) RMK->registrationform.ui.h->PrintCheck() - подправлена печать слипов. Условие !data.Empty() не срабатывает, т.к. в ответе приходит несколько пустых строк,
    что на самом деле фактически равно пустым данным, но алгоритмически таковым не является.

#------------05/10/2011------------------
1) RMK->registrationform.ui.h - исправлена функция ShowQuantitySet() так, чтобы она не затрагивала строчку основного поля ввода, если данные получены от весов
    (иначе в случае [набрали код/цену]->[пришел вес с весов]->[нажали F2/F4] выскакивала ошибка о некорректном коде/цене товара)

#------------30/09/2011------------------
1) StateStore->statestore.cpp/statestore.h - добавлена обработка состояния MESS (иначе при переходе в данное состояние
	сбрасывается текущее состояние (например, начисленной скидки). Актуально, если используется настройка 
	"выводить сообщения об ошибках в поле ввода"
2) Receipt->receipt.cpp->Add_Percent_Discount() - исправлен алгоритм, отрабатывающий запрет на начисление скидки по минимальной цене позиций
3) RMK->registrationform.ui.h->BarcodeEvent, CardEvent - разрешено начисление скидки на чек по карте/штрих-коду без нажатия клавиши ПРОМИТОГ
4) RMK->registrationform.ui.h->CheckReduction() - добавлен вывод расшифровки по начисленной скидке на чек в поле ввода
5) RMK->paymenttypeform.ui.h->SetNalPaymentSumm() - отключено открытие окна комбинированной оплаты в случае превышения ограничения наличных по макс. купюре.

#------------29/09/2011------------------
1) PostgresLib->trans_data.h - исправлена нумерация полей к выгрузке по транзакциям скидок в формате АТОЛ (иначе по транзакциям, сформированным более ранними сборками ДЭНСИ: КАССы, данные выгружаются неполные)

#------------17/09/2011------------------
1) HWSRV->kkm_prim.cpp - исправлена функция чтения ответа от ФР линейки ПРИМ (проявлялось отсутствием связи при корректных настройках) 

#------------30/08/2011------------------
1) исправлена ошибка сегментирования памяти в интерфейсе настройки оборудования (confGUI), возникавшая при проверке связи или сохранении схемы настроек, если хотя бы одно из устройств настроено на порт с номером > 20. Теперь корректная работа возможна со 100 портами каждого вида, а в случае превышения 100 номера порта выдается сообщение об ошибке.

#------------29/08/2011------------------
1) InsertTransaction/insert_transaction.cpp - скорректирована запись танзакций по сторнированным позициям - отменена запись транзакций налогов и скидок на позицию,
    если данная позиция сторнирована
2) PostgresLib/trans_data.cpp - подправлена выгрузка данных по транзакциям 56 и 12 для протокола АТОЛ. Теперь данные выгружаются полные.

#------------19/08/2011------------------
1) исправлена печать регистраций на Феликс-02К (строка с кодом товара при кол-ве <> 1 не помещалась на ленту 44 мм.)

#------------04/08/2011------------------
1) исправлена функция установки кол-ва в РМК (для quantity = 0.001)

#------------03/08/2011------------------
1) добавлены регистрация/визуальный подбор по цене (F4)

#------------28/07/2011------------------
1) разблокирована возможность возврата типом оплаты №3
2) добавлен функционал бонусных карт:
    - загрузка фиксированных скидок по протоколу ДЭНСИ с типом 4 (бонусная карта)
    - для бонусной карты указывается процент начисляемых бонусов от суммы чека, текущая сумма бонусов, доступная для снятия, максимальный процент от суммы чека, который можно оплатить бонусами
    - при начислении фиксир. скидки на чек, если у нее тип 4, кассиру выдается окно по данной карте с указанием названия, суммы бонусов, процента, суммы, доступной для снятия (с учетом суммы чека)
    - снятие бонусов попадает в транзакции, как суммовая скидка по карте
    - продажа по бонусной карте без снятия бонусов попадает в транзакции как нулевая скидка по данной карте.

#------------21/07/2011------------------
1) исправлена печать программных отчетов (по кассирам/товарам) 

#------------21/07/2011------------------
1) Подправлена утилита обновления структуры БД DBUpdate для перехода с ранних сборок ДЭНСИ: КАССы

#------------19/07/2011------------------
1) Добавлен функционал вычисления процента скидки по карте по условиям, заданным в схеме, код которой указан для данной карты (фиксированной скидки)


#------------11/07/2011------------------
1) DBUpdate - добавлено необходимое для перехода на 1.2.6
2) Исправлена загрузка товаров, в наименованиях/артикулах которых присутствуют символы ['][\][;]

#------------08/07/2011------------------
1) WareProject - добавлена работа с секциями 

#------------30/06/2011------------------
1) Upload->DncCommand.cpp->DncCommandAddFixedDiscount()
    исправлена нумерация параметров в разбираемой строке для штрих-кода карты и признака видимости;

#------------14/06/2011------------------
1). addon_func.cpp->Round() исправлено округление чисел вида xx.5 (пример - 5386.5 округлялось до 5386 вместо 5387, т.к. в double это число хранится в виде 5386.4(9) )
2). HWSRV-> addon.cpp - то же исправление Round()
3). PostgresLib->reg_pgsql.cpp->New_Receipt_Record() добавлено округление суммы при объединении позиций
4). RMK->registrationform.ui.h->ReductionPriсe() добавлено округление суммы при изменении цены
5). RMK->registrationform.ui.h->ReductionQuantity() добавлено округление суммы при изменении количества

#------------07/06/2011------------------
1) Service -> reportform.ui.h
    - исправлен алгоритм сброса суммы фискальной секции на данные из регистра ФР (ранее было сделано через функцию zeroCashSumInSection(), 
    которая не работает для секций, у которых не установлена автоинкассация)
2) RMK -> registrationform.ui.h -> init(), SumInBox()
    - см. исправления в п.1

#------------06/06/2011------------------
1) Service -> reportform.ui.h -> TakeReport()
    - добавлен сброс суммы фискальной секции на данные из регистра ФР после снятия Z-отчета (для учета аппаратной автоинкассации) 
2) RMK -> registrationform.ui.h -> init(), SumInBox()
    - добавлен сброс суммы фискальной секции на данные из регистра ФР 
3) Service -> reportform.ui.h -> PrintCashierDiscountInfo()
    - добавлена печать количеств и сумм по отменам и сторно чеков продаж 
4) PostgresLib -> trans_pgsql.h, trans_pgsql.cpp
    - добавлены функции запросов количеств и сумм по отменам и сторно чеков продаж (4 шт.)
5) daemon_unload -> Writer.cpp
    - из параметра PROGRAM_VERSION при записи в файл отчета по протокулу ДЭНСИ убирается кириллическая строчка с названием программы, чтобы не было
	проблем с кодировками
#------------04/06/2011------------------
1) RMK -> registrationform.ui.h -> CancelReduction()
    - исправлен вылет в основное меню при нажатии [Cntrl+C] на пустом чеке возврата

#------------02/06/2011------------------
1) Receipt -> receipt.cpp -> GetSectionNumWithMaxSum()
    - исправлен SIGSEGV, возникавший при попытке закрыть чек продажи/возврата, когда не настроено ни одной секции

#------------23/05/2011------------------
1) daemon_unload 
    - добавлена поддержка команд протокола ДЭНСИ (основные - NEWSALES, ALLSALES, SALESOFTIMERANGE)
    - добавлено формирование заголовков отчетов по протоколу ДЭНСИ (порядок полей в заголовке слегка изменен, см. документацию)
2) ServiceLib
    - добавлен учет протокола обмена при формировании команды выгрузки транзакций по диапазону дат
3) addonfunc
    - добавлена функция str_currentdtime(), которая возвращает строку с текущими датой/временем в формате "dd.mm.yyyy hh:mm:ss"

#------------18/05/2011------------------
1) во вьюшку transactions_by_last_session внесены изменения (см. update_tr.sql) с тем, чтобы транзакции текущей смены отбирались корректно, 
    даже если в БД еще не было ни одного закрытия смены.

#------------17/05/2011------------------
1) InsertTransaction -> insert_transaction.cpp -> InsertEnteringGettingTransaction()
    - добавлена обработка кол-ва секций. Раньше если секции не настроены при попытке внесения/выплаты возникал SIGSEGV.
2) заменены HWSRV и DevicesConf для поддержки Касби-02/04
3) RMK -> registrationform:
    - добавлена обработка ошибки при вызове OpenCheck() в Registration() и ReturnRegistration()
    - закомментировано отображение спец. картинки для ККМ Касби-02 - теперь работает в режиме ФР
    - добавлены условия на протокол №7 (Касби-04), аналогичные протоколу №6 (Касби-02) в функциях Registration() и ReturnRegistration()
4) KkmRegistration -> KkmPrintCopyCheckInfoByProtocol()
    - добавлен анализ типа чека для печати строки "ПРОДАЖА/ВОЗВРАТ ПРОДАЖИ" в итогах чека для протокола ШТРИХ
5) ReaderConfig -> в конструктор добавлен поиск .conf-файла сначала в $HOME/.dnc/, а затем уже в папке, указанной в const_conf.h

#------------13/05/2011------------------
1) RMK -> registrationform -> SumInBox()
    - для функции просмотра наличности в денежном ящике добавлена проверка права №23 (= право на выплату денег из кассы)
2) dncwaresystem -> WareFlags.cpp
    - исправлен порядок флагов товара при загрузке (был обратный - обнаружили тестеры из г. Иваново)
    - добавлено значение по умолчанию для флагов = 0x100 - печать в чеке разрешена

#------------12/05/2011------------------
1) servicelib -> reportform -> PrintSectionReport()
- добавлена печать вычисляемого регистра "нал. в кассе на начало смены"
2) SectionSetup -> настройка автоинкассации сделана недоступной для фискальной секции

#------------04/05/2011------------------
1) trans_pgsql.h, trans_pgsql.cpp:
- добавлены функции GetIncomeSumBySection(), GetOutcomeSumBySection() и все, что ниже них по исходникам

2) servicelib -> reportform -> PrintSectionReport()
- добавлена печать регистров по секциям:
    - сумма внесений за смену
    - сумма выплат за смену
    - сумма выручки за смену
    - сумма продаж в секцию с учетом скидок и округлений
    - сумма возвратов в секцию с учетом скидок и округлений
    - сумма сторнированных позиций по чекам продаж (без округлений)
    - сумма по отмененным чекам продаж (без округлений)
    
3) trans_pgsql.cpp:
- кое-где в последних функциях добавлены недостающие free(str)

4) ОБНАРУЖЕНА ОШИБКА!!! Не учитывается предварительно введенное количество товара при регистрации по коду (надо проверить остальные способы)
- AddWareController->::AddWare() добавлено восстановление quantity после вызова AddWareByAdditions() для регистрации с предварительным вводом количества









